<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
<html lang="ko">
<head>
    <title>{% block title %}ğŸ” ê²€ìƒ‰ ê²°ê³¼</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'css/search_results.css' %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        
#preloader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-image: url("{% static 'images/ë¦¬ë“œë°°ê²½.jpg' %}");
    z-index: 9999;
    display: none;
}

.curtain {
    position: fixed;
    top: 0;
    width: 50%;
    height: 100%;
    background-image: url("{% static 'images/ì»¤íŠ¼.jpg' %}"); /* ì»¤íŠ¼ ì´ë¯¸ì§€ ê²½ë¡œ */
    background-size: cover;
    z-index: 10000;
}

#curtain-left {
    left: 0;
    animation: curtainDown 1s forwards;
}

#curtain-right {
    right: 0;
    animation: curtainDown 1s forwards;
}

#loading-message {
    position: absolute;
    z-index: 10001;
    font-size: 2em;
    color: #000;
}

@keyframes curtainDown {
0% {
top: -100%;
}
100% {
top: 0;
}
}


.link-click-animation {
    position: relative;
    overflow: hidden;
    display: inline-block;
}
.link-click-animation::before {
    content: "";
    position: absolute;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.1);
    top: 0;
    left: -100%;
    transition: left 0.3s ease;
    z-index: -1;
}
.link-click-animation:hover::before {
    left: 0;
}
    </style>
</head>{% endblock %}
{% block content %}
<body>
    <div id="preloader">
        <div id="curtain-left" class="curtain"></div>
        <div id="curtain-right" class="curtain"></div>
        <!--<div id="loading-message">Loading...</div>-->
    </div>
    <div class="search-results-container">
        <h1 class='h'>ğŸ” ê²€ìƒ‰ ê²°ê³¼</h1>
        <div class="books">
            <ul class="gallery">
                {% for story in stories %}
                <li class='book container1'>
                    <div class="overlay"></div>
                    <a href="{% url 'reader:story_detail' story.id %}?keyword={{ keyword }}">
                        {% if story.image %}
                            <img class="card" src="{{ story.image.url }}" alt="{{ story.title }}">
                        {% else %}
                            <img class="card" src="{% static 'images/ìƒì.png' %}" alt="{{ story.title }}">  <!-- ê¸°ë³¸ ì´ë¯¸ì§€ ê²½ë¡œ ì„¤ì • -->
                        {% endif %}
                        <span class="book-title">{{ story.title }}</span>
                    </a>
                </li>
            {% endfor %}
            </ul>
            
        </div>
    </div>
    <script>
        $(document).ready(function() {
            $('.link-click-animation').on('click', function(e) {
                // í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë§‰ìŒ (ê¸°ë³¸ ë™ì‘ ë°©ì§€)
                e.preventDefault();
        
                // í”„ë¦¬ë¡œë” ë³´ì´ê¸°
                $('#preloader').show();
        
                // ì‹¤ì œ í˜ì´ì§€ë¡œ ì´ë™
                setTimeout(function() {
                    // ì‹¤ì œ í˜ì´ì§€ URL ê°€ì ¸ì˜¤ê¸°
                    var targetUrl = $('.link-click-animation').attr('href');
                    
                    // í˜ì´ì§€ ì´ë™
                    window.location.href = targetUrl;
                }, 1000); // ì˜ˆì‹œë¡œ 1ì´ˆ í›„ì— í˜ì´ì§€ ì´ë™ (í”„ë¦¬ë¡œë” ì‹œë®¬ë ˆì´ì…˜)
            });
        
            // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì‹¤í–‰ë  ì½œë°± í•¨ìˆ˜
            $(window).on('load', function() {
                // í˜ì´ì§€ ë¡œë“œê°€ ì™„ë£Œë˜ë©´ í”„ë¦¬ë¡œë” ìˆ¨ê¸°ê¸°
                $('#preloader').hide();
            });
        });
        // ëª¨ë“  .container1 ìš”ì†Œë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
        var containers = document.querySelectorAll('.container1');
        
        // ê° .container1 ìš”ì†Œì— ëŒ€í•´ ë°˜ë³µí•©ë‹ˆë‹¤.
        containers.forEach(function(container) {
            var overlay = container.querySelector('.overlay');
            var timeout;
        
            // ë§ˆìš°ìŠ¤ê°€ ìš”ì†Œ ìœ„ì—ì„œ ì›€ì§ì¼ ë•Œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
            container.addEventListener('mousemove', function(e) {
                var x = e.offsetX;
                var y = e.offsetY;
                var rotateY = -1 / 5 * x + 20;
                var rotateX = 4 / 30 * y - 20;
        
                overlay.style.backgroundPosition = `${x / 5 + y / 5}%`;
                overlay.style.filter = `opacity(${x / 200}) brightness(1.2)`;
        
                container.style.transition = 'transform 0.1s ease'; // transform ì†ì„±ì— transitionì„ ì¶”ê°€í•©ë‹ˆë‹¤.
                container.style.transform = `perspective(350px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        
                // ì´ì „ì— ì„¤ì •ëœ timeoutì„ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
                clearTimeout(timeout);
            });
        
            // ë§ˆìš°ìŠ¤ê°€ ìš”ì†Œë¥¼ ë²—ì–´ë‚  ë•Œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
            container.addEventListener('mouseout', function() {
                overlay.style.filter = 'opacity(0)';
                // 0.2ì´ˆ í›„ì— transform ì†ì„±ì„ ì›ë˜ ìƒíƒœë¡œ ë˜ëŒë¦¬ë„ë¡ setTimeoutì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
                timeout = setTimeout(function() {
                    container.style.transition = 'transform 0.1s ease'; // transform ì†ì„±ì— transitionì„ ì¶”ê°€í•©ë‹ˆë‹¤.
                    container.style.transform = 'perspective(350px) rotateY(0deg) rotateX(0deg)';
                }, 150); // 0.2ì´ˆ(200ë°€ë¦¬ì´ˆ) í›„ì— ì‹¤í–‰ë©ë‹ˆë‹¤.
            });
        });
      </script>
</body>
</html>
{% endblock %}
